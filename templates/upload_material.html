{% extends "base.html" %}
{% block content %}

<div class="container my-5">
  <div class="card shadow-sm p-4">
    <h4 class="text-primary mb-4">📚 Upload Course Material</h4>

    <form method="POST" enctype="multipart/form-data">
      <div class="mb-3">
        <label class="form-label">🎓 Select Course</label>
        <select name="course_id" class="form-select" required>
          <option value="" disabled selected>-- Select Course --</option>
          {% for course in courses %}
          <option value="{{ course.id }}">{{ course.name }} ({{ course.code }})</option>
          {% endfor %}
        </select>
      </div>

      <div class="mb-3">
        <label class="form-label">📌 Title</label>
        <input type="text" name="title" class="form-control" placeholder="Enter material title" required>
      </div>

      <div class="mb-3">
        <label class="form-label">📁 Select File</label>
        <input type="file" name="file" class="form-control" required>
      </div>

      <div class="text-end">
        <button type="submit" class="btn btn-success">✅ Upload</button>
      </div>
    </form>
  </div>

  {% for course in courses %}
    {% if course.materials %}
    <div class="card mt-5 p-4">
      <h5 class="text-secondary mb-3">📂 {{ course.name }} Materials</h5>
      <table class="table table-bordered table-striped">
        <thead class="table-light">
          <tr>
            <th>Title</th>
            <th>Type</th>
            <th>Filename</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          {% for m in course.materials %}
          <tr>
            <td>{{ m.title }}</td>
            <td><span class="badge bg-info">{{ m.filetype }}</span></td>
            <td>{{ m.filename }}</td>
            <td>
              <a href="{{ url_for('api.download_material', id=m.id) }}" class="btn btn-sm btn-primary">🔽 Download</a>
              <form method="POST" action="{{ url_for('api.delete_material', id=m.id) }}" style="display:inline;">
                <button type="submit" class="btn btn-sm btn-danger">🗑️ Delete</button>
              </form>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
    {% endif %}
  {% endfor %}
</div>

{% endblock %}