{% extends "base.html" %}
{% block content %}

<div class="container my-5">
  <div class="card shadow-lg rounded-4">
    <div class="card-body p-4">

      <div class="text-center mb-4">
        <h2 class="fw-bold text-warning"><i class="bi bi-people-fill me-2"></i> Students List</h2>
        <p class="text-muted fst-italic">Session-wise student records</p>
        <hr class="w-50 mx-auto mb-4">
      </div>

      <!-- Session Selection -->
      <form method="POST" class="mb-4 text-center">
        <div class="input-group w-50 mx-auto">
          <select name="session" class="form-select" required>
            <option value="">Select Session</option>
            {% for session in sessions %}
              <option value="{{ session }}" {% if selected_session == session %}selected{% endif %}>{{ session }}</option>
            {% endfor %}
          </select>
          <button type="submit" class="btn btn-warning"><i class="bi bi-eye me-1"></i> View</button>
        </div>
      </form>

      {% if students %}
      <div class="table-responsive">
        <table class="table table-hover table-bordered align-middle text-center">
          <thead class="table-warning">
            <tr>
              <th>Roll</th>
              <th>Name</th>
              <th>Mobile</th>
              <th>Email</th>
              <th>Father's Name</th>
              <th>Mother's Name</th>
              <th>Action</th>
            </tr>
          </thead>
          <tbody>
            {% for s in students %}
            <tr onclick="window.location.href='{{ url_for('api.edit_student', id=s.id) }}'" style="cursor:pointer">
              <td>{{ s.roll }}</td>
              <td>{{ s.name }}</td>
              <td>{{ s.mobile or '' }}</td>
              <td>{{ s.email or '' }}</td>
              <td>{{ s.father_name or '' }}</td>
              <td>{{ s.mother_name or '' }}</td>
              <td>
                <a href="{{ url_for('api.edit_student', id=s.id) }}" class="btn btn-sm btn-primary me-1"><i class="bi bi-pencil-square"></i></a>
                <form action="{{ url_for('api.delete_student', id=s.id) }}" method="POST" class="d-inline">
                  <button type="submit" class="btn btn-sm btn-danger" onclick="return confirm('Are you sure?')"><i class="bi bi-trash"></i></button>
                </form>
              </td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>

      <div class="mt-3 text-center">
        <a href="{{ url_for('api.export_students', session=selected_session, format='excel') }}" class="btn btn-success me-2"><i class="bi bi-file-earmark-excel"></i> Export Excel</a>
        <a href="{{ url_for('api.export_students', session=selected_session, format='pdf') }}" class="btn btn-danger"><i class="bi bi-file-earmark-pdf"></i> Export PDF</a>
      </div>
      {% else %}
        <p class="text-center text-muted mt-4">No students found for this session.</p>
      {% endif %}

    </div>
  </div>
</div>

{% endblock %}